import tempfile
import json
import unittest
import sys
from unittest import TestCase
from pagesetparser.pageset import Pageset
import pagesetparser.core as core
sys.path.append('..') 



# These are the tests for the grid 
class gridTest(TestCase):

    CK20=None #This is the pageset

    def get_singleton_grid(self):
        if not self.CK20:
            self.CK20 = Pageset("tests/testinputs/CK20V2cutdown.pptx",5, False) #TODO - this makes the file hard to run from outside the base directory 
            
        return self.CK20.grids[0]

    def test_col_row_by_num(self): 
        grid = self.get_singleton_grid()
        self.assertEqual(grid.get_col_row_by_num(5083720,8158320),(4,3))
        self.assertEqual(grid.get_col_row_by_num(3609180,941940),(0,2))
        self.assertEqual(grid.get_col_row_by_num(1639980,2780820),(1,1))
        self.assertEqual(grid.get_col_row_by_num(1639980,8139780),(4,1))
        self.assertEqual(grid.get_col_row_by_num(1670400,2780820),(1,1))
        self.assertEqual(grid.get_col_row_by_num(1670400,4571820),(2,1))
        self.assertEqual(grid.get_col_row_by_num(1670400,6362460),(3,1))
        self.assertEqual(grid.get_col_row_by_num(1670400,8139780),(4,1))
        self.assertEqual(grid.get_col_row_by_num(1670400,8140500),(4,1))
        self.assertEqual(grid.get_col_row_by_num(1670400,952020),(0,1))
        self.assertEqual(grid.get_col_row_by_num(1670580,4571820),(2,1))
        self.assertEqual(grid.get_col_row_by_num(1680840,2780820),(1,1))
        self.assertEqual(grid.get_col_row_by_num(1682280,4558140),(2,1))
        self.assertEqual(grid.get_col_row_by_num(1685880,952020),(0,1))
        self.assertEqual(grid.get_col_row_by_num(1701000,4571820),(2,1))
        self.assertEqual(grid.get_col_row_by_num(1731240,4571820),(2,1))
        self.assertEqual(grid.get_col_row_by_num(1731240,6362460),(3,1))
        self.assertEqual(grid.get_col_row_by_num(1792080,2780820),(1,1))
        self.assertEqual(grid.get_col_row_by_num(1792080,8139780),(4,1))
        self.assertEqual(grid.get_col_row_by_num(2015100,7765740),(4,1))
        self.assertEqual(grid.get_col_row_by_num(2039760,4094640),(2,1))
        self.assertEqual(grid.get_col_row_by_num(2043180,2704860),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2043180,2957940),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2053322,2742516),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2056860,5943060),(3,1))
        self.assertEqual(grid.get_col_row_by_num(2069280,945000),(0,1))
        self.assertEqual(grid.get_col_row_by_num(2069640,2773800),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2084760,2755980),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2085120,2780820),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2085120,4571820),(2,1))
        self.assertEqual(grid.get_col_row_by_num(2085120,6362460),(3,1))
        self.assertEqual(grid.get_col_row_by_num(2085120,8139780),(4,1))
        self.assertEqual(grid.get_col_row_by_num(2085120,8140500),(4,1))
        self.assertEqual(grid.get_col_row_by_num(2085120,952020),(0,1))
        self.assertEqual(grid.get_col_row_by_num(2085120,977220),(0,1))
        self.assertEqual(grid.get_col_row_by_num(2088000,8191260),(4,1))
        self.assertEqual(grid.get_col_row_by_num(2095020,2552220),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2095560,2780820),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2098176,8138160),(4,1))
        self.assertEqual(grid.get_col_row_by_num(2102400,2681100),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2102400,6262380),(3,1))
        self.assertEqual(grid.get_col_row_by_num(2104020,6371100),(3,1))
        self.assertEqual(grid.get_col_row_by_num(2107560,2780820),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2117160,6314012),(3,1))
        self.assertEqual(grid.get_col_row_by_num(2138220,8080380),(4,1))
        self.assertEqual(grid.get_col_row_by_num(2138772,4606247),(2,1))
        self.assertEqual(grid.get_col_row_by_num(2158560,4599900),(2,1))
        self.assertEqual(grid.get_col_row_by_num(2167920,2820780),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2170709,4607289),(2,1))
        self.assertEqual(grid.get_col_row_by_num(2178423,6313393),(3,1))
        self.assertEqual(grid.get_col_row_by_num(2180880,8029080),(4,1))
        self.assertEqual(grid.get_col_row_by_num(2185020,2988900),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2188440,5007600),(2,1))
        self.assertEqual(grid.get_col_row_by_num(2189160,8254800),(4,1))
        self.assertEqual(grid.get_col_row_by_num(2194020,8244900),(4,1))
        self.assertEqual(grid.get_col_row_by_num(2200500,2583000),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2206980,4190580),(2,1))
        self.assertEqual(grid.get_col_row_by_num(2209500,8208180),(4,1))
        self.assertEqual(grid.get_col_row_by_num(2210220,6323220),(3,1))
        self.assertEqual(grid.get_col_row_by_num(2218412,2780820),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2218860,4562100),(2,1))
        self.assertEqual(grid.get_col_row_by_num(2220840,8141760),(4,1))
        self.assertEqual(grid.get_col_row_by_num(2222100,4660380),(2,1))
        self.assertEqual(grid.get_col_row_by_num(2222100,6362460),(3,1))
        self.assertEqual(grid.get_col_row_by_num(2225340,1002780),(0,1))
        self.assertEqual(grid.get_col_row_by_num(2226420,8017740),(4,1))
        self.assertEqual(grid.get_col_row_by_num(2227140,8488800),(4,1))
        self.assertEqual(grid.get_col_row_by_num(2228400,2800080),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2233260,966420),(0,1))
        self.assertEqual(grid.get_col_row_by_num(2238660,6658380),(3,1))
        self.assertEqual(grid.get_col_row_by_num(2247480,5918040),(3,1))
        self.assertEqual(grid.get_col_row_by_num(2247660,2743020),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2249460,6697260),(3,1))
        self.assertEqual(grid.get_col_row_by_num(2253780,2774700),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2253780,4571460),(2,1))
        self.assertEqual(grid.get_col_row_by_num(2253960,6356160),(3,1))
        self.assertEqual(grid.get_col_row_by_num(2259565,6370200),(3,1))
        self.assertEqual(grid.get_col_row_by_num(2274480,2895120),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2278620,4572720),(2,1))
        self.assertEqual(grid.get_col_row_by_num(2279340,4565340),(2,1))
        self.assertEqual(grid.get_col_row_by_num(2285640,2374560),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2411640,2774700),(1,1))
        self.assertEqual(grid.get_col_row_by_num(2411640,6413248),(3,1))
        self.assertEqual(grid.get_col_row_by_num(2411640,8139780),(4,1))
        self.assertEqual(grid.get_col_row_by_num(2412540,8533980),(4,1))
        self.assertEqual(grid.get_col_row_by_num(2439444,4574324),(2,1))
        self.assertEqual(grid.get_col_row_by_num(2983500,6362460),(3,2))
        self.assertEqual(grid.get_col_row_by_num(2986200,6362460),(3,2))
        self.assertEqual(grid.get_col_row_by_num(2991060,2780820),(1,2))
        self.assertEqual(grid.get_col_row_by_num(2991060,4571820),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3003840,6362460),(3,2))
        self.assertEqual(grid.get_col_row_by_num(3021480,2780820),(1,2))
        self.assertEqual(grid.get_col_row_by_num(3021480,4571820),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3021480,8139780),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3021480,952020),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3028680,4571820),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3028680,8140500),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3028680,952020),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3042000,6299820),(3,2))
        self.assertEqual(grid.get_col_row_by_num(3042000,6362460),(3,2))
        self.assertEqual(grid.get_col_row_by_num(3045420,2780820),(1,2))
        self.assertEqual(grid.get_col_row_by_num(3062160,2780820),(1,2))
        self.assertEqual(grid.get_col_row_by_num(3082320,4571820),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3082320,8139780),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3082320,952020),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3102840,952020),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3269340,5031360),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3301920,2336040),(1,2))
        self.assertEqual(grid.get_col_row_by_num(3301920,3250440),(1,2))
        self.assertEqual(grid.get_col_row_by_num(334440,8139780),(4,0))
        self.assertEqual(grid.get_col_row_by_num(334440,952020),(0,0))
        self.assertEqual(grid.get_col_row_by_num(3352320,7772040),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3359520,2811960),(1,2))
        self.assertEqual(grid.get_col_row_by_num(3359520,6621840),(3,2))
        self.assertEqual(grid.get_col_row_by_num(3375000,2938140),(1,2))
        self.assertEqual(grid.get_col_row_by_num(3400920,6362460),(3,2))
        self.assertEqual(grid.get_col_row_by_num(3400920,8139780),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3401460,4598460),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3407400,6307200),(3,2))
        self.assertEqual(grid.get_col_row_by_num(3428640,8140500),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3428640,952020),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3436200,2780820),(1,2))
        self.assertEqual(grid.get_col_row_by_num(3436200,4571820),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3436200,952020),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3436200,977220),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3441780,8071200),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3441780,8387280),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3443400,4571820),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3449160,8138160),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3449160,8140500),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3456720,2780820),(1,2))
        self.assertEqual(grid.get_col_row_by_num(3456720,4558140),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3456720,4571820),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3456720,6362460),(3,2))
        self.assertEqual(grid.get_col_row_by_num(3456720,8191260),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3466620,6057540),(3,2))
        self.assertEqual(grid.get_col_row_by_num(3470400,4537080),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3482280,826920),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3484047,2812598),(1,2))
        self.assertEqual(grid.get_col_row_by_num(3492360,1267020),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3493980,8142300),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3496860,973620),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3499584,4642596),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3502959,6329022),(3,2))
        self.assertEqual(grid.get_col_row_by_num(3504780,898200),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3506220,2817540),(1,2))
        self.assertEqual(grid.get_col_row_by_num(3516660,8471700),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3518640,6393960),(3,2))
        self.assertEqual(grid.get_col_row_by_num(3523680,4571820),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3536100,4603140),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3537980,6362459),(3,2))
        self.assertEqual(grid.get_col_row_by_num(3538260,4343220),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3548520,927000),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3548700,8197020),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3557160,4900320),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3565620,6413220),(3,2))
        self.assertEqual(grid.get_col_row_by_num(3566160,2820420),(1,2))
        self.assertEqual(grid.get_col_row_by_num(3567060,996660),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3568500,2755620),(1,2))
        self.assertEqual(grid.get_col_row_by_num(3568500,7708140),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3569760,2800080),(1,2))
        self.assertEqual(grid.get_col_row_by_num(3570480,1000800),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3576780,6291000),(3,2))
        self.assertEqual(grid.get_col_row_by_num(3580920,2822040),(1,2))
        self.assertEqual(grid.get_col_row_by_num(3580920,4571640),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3580920,990360),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3583440,8178480),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3584340,4552560),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3585960,8094960),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3587400,983880),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3594960,2749320),(1,2))
        self.assertEqual(grid.get_col_row_by_num(3600000,2800080),(1,2))
        self.assertEqual(grid.get_col_row_by_num(3600360,970920),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3608280,4574160),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3609180,941940),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3655800,6357240),(3,2))
        self.assertEqual(grid.get_col_row_by_num(3669840,6507900),(3,2))
        self.assertEqual(grid.get_col_row_by_num(3756240,2793240),(1,2))
        self.assertEqual(grid.get_col_row_by_num(3756240,6431788),(3,2))
        self.assertEqual(grid.get_col_row_by_num(3756240,8158320),(4,2))
        self.assertEqual(grid.get_col_row_by_num(3770712,918000),(0,2))
        self.assertEqual(grid.get_col_row_by_num(3784044,4592864),(2,2))
        self.assertEqual(grid.get_col_row_by_num(3786840,938340),(0,2))
        self.assertEqual(grid.get_col_row_by_num(4306860,2780820),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4306860,4571820),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4306860,952020),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4322160,2780820),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4327380,4564260),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4337280,2780820),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4337280,4571820),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4337280,6362460),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4337280,8139780),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4337280,952020),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4343040,6310980),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4357620,959580),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4357800,4571820),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4357800,6343380),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4357800,8114940),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4357800,8140500),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4380480,952020),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4398120,2780820),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4398120,4571820),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4398120,8139780),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4398120,952020),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4418640,2780820),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4428540,6362460),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4430160,952020),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4489380,8139780),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4640400,8721540),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4641120,6622200),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4652460,6651180),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4672800,6057360),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4701420,973260),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4717440,6711840),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4724640,8304840),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4752000,2780820),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4752000,4571820),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4752000,6362460),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4752000,8139780),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4752000,952020),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4752000,977220),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4762260,2476260),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4762260,4305060),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4762260,5905260),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4762260,7886340),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4766940,4571820),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4768380,2774700),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4768380,3003300),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4770180,4095540),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4772520,2780820),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4772520,4571820),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4772520,6362460),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4772520,8140500),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4772520,8191260),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4772520,952020),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4775400,4564260),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4778448,8143240),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4785840,2780820),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4785840,959580),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4800060,8380980),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4800240,4679460),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4800420,4255920),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4802940,494820),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4809288,2753121),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4812732,8139779),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4826190,941921),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4828320,4752360),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4828500,5029020),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4830660,3136500),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4833401,8149204),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4838040,6285960),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4839840,1155600),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4841324,2767272),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4843440,1402920),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4851720,4609800),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4859280,482040),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4859820,926820),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4863780,998460),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4869900,997020),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4879260,8320860),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4879800,2787300),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4882320,6343560),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4885560,4933440),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4885920,6391080),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4887900,8159220),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4888620,6412500),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4894020,6397740),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4895640,8210160),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4896360,3033720),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4896720,4584960),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4908060,8197740),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4909728,2780820),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4910940,4235220),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4912920,6371100),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4919760,2481120),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4921020,958500),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4924800,2767680),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4930740,4540500),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4935600,2488680),(1,3))
        self.assertEqual(grid.get_col_row_by_num(4945860,6407100),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4946220,983700),(0,3))
        self.assertEqual(grid.get_col_row_by_num(4953060,6317640),(3,3))
        self.assertEqual(grid.get_col_row_by_num(4976100,8229240),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4991400,8115840),(4,3))
        self.assertEqual(grid.get_col_row_by_num(4994640,4773600),(2,3))
        self.assertEqual(grid.get_col_row_by_num(4997520,4571640),(2,3))
        self.assertEqual(grid.get_col_row_by_num(5031864,920356),(0,3))
        self.assertEqual(grid.get_col_row_by_num(5083720,2793240),(1,3))
        self.assertEqual(grid.get_col_row_by_num(5083720,6431788),(3,3))
        self.assertEqual(grid.get_col_row_by_num(5111524,4592864),(2,3))
        self.assertEqual(grid.get_col_row_by_num(5225760,4285980),(2,3))
        self.assertEqual(grid.get_col_row_by_num(5678460,4571820),(2,4))
        self.assertEqual(grid.get_col_row_by_num(5688720,952020),(0,4))
        self.assertEqual(grid.get_col_row_by_num(5693760,2755980),(1,4))
        self.assertEqual(grid.get_col_row_by_num(5695560,4571820),(2,4))
        self.assertEqual(grid.get_col_row_by_num(5708880,2780820),(1,4))
        self.assertEqual(grid.get_col_row_by_num(5708880,4571820),(2,4))
        self.assertEqual(grid.get_col_row_by_num(5708880,6362460),(3,4))
        self.assertEqual(grid.get_col_row_by_num(5708880,8139780),(4,4))
        self.assertEqual(grid.get_col_row_by_num(5708880,952020),(0,4))
        self.assertEqual(grid.get_col_row_by_num(5729400,2780820),(1,4))
        self.assertEqual(grid.get_col_row_by_num(5729400,4571820),(2,4))
        self.assertEqual(grid.get_col_row_by_num(5729400,4573260),(2,4))
        self.assertEqual(grid.get_col_row_by_num(5729400,6343380),(3,4))
        self.assertEqual(grid.get_col_row_by_num(5729400,6362460),(3,4))
        self.assertEqual(grid.get_col_row_by_num(5729400,8139780),(4,4))
        self.assertEqual(grid.get_col_row_by_num(5729400,927180),(0,4))
        self.assertEqual(grid.get_col_row_by_num(5729400,952020),(0,4))
        self.assertEqual(grid.get_col_row_by_num(5769720,2780820),(1,4))
        self.assertEqual(grid.get_col_row_by_num(5769720,952020),(0,4))
        self.assertEqual(grid.get_col_row_by_num(5851080,4571820),(2,4))
        self.assertEqual(grid.get_col_row_by_num(6026040,6788160),(3,4))
        self.assertEqual(grid.get_col_row_by_num(6051863,8127854),(4,4))
        self.assertEqual(grid.get_col_row_by_num(6058080,5904720),(3,4))
        self.assertEqual(grid.get_col_row_by_num(6082020,519660),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6088680,1378440),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6109745,4571820),(2,4))
        self.assertEqual(grid.get_col_row_by_num(6118740,952020),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6123600,2755980),(1,4))
        self.assertEqual(grid.get_col_row_by_num(6123600,2780820),(1,4))
        self.assertEqual(grid.get_col_row_by_num(6123600,4564260),(2,4))
        self.assertEqual(grid.get_col_row_by_num(6123600,4571820),(2,4))
        self.assertEqual(grid.get_col_row_by_num(6123600,6362460),(3,4))
        self.assertEqual(grid.get_col_row_by_num(6123600,8127360),(4,4))
        self.assertEqual(grid.get_col_row_by_num(6123600,8139780),(4,4))
        self.assertEqual(grid.get_col_row_by_num(6123600,8140500),(4,4))
        self.assertEqual(grid.get_col_row_by_num(6123600,952020),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6123600,964440),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6133860,414900),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6137809,996660),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6144120,2780820),(1,4))
        self.assertEqual(grid.get_col_row_by_num(6144120,4571820),(2,4))
        self.assertEqual(grid.get_col_row_by_num(6144120,6362460),(3,4))
        self.assertEqual(grid.get_col_row_by_num(6144120,8140500),(4,4))
        self.assertEqual(grid.get_col_row_by_num(6144120,8165340),(4,4))
        self.assertEqual(grid.get_col_row_by_num(6144120,952020),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6144120,977220),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6148080,1042920),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6149714,4564888),(2,4))
        self.assertEqual(grid.get_col_row_by_num(6152090,1009372),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6162510,6328851),(3,4))
        self.assertEqual(grid.get_col_row_by_num(6164280,2704500),(1,4))
        self.assertEqual(grid.get_col_row_by_num(6164640,1378440),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6173741,8119815),(4,4))
        self.assertEqual(grid.get_col_row_by_num(6192552,2821680),(1,4))
        self.assertEqual(grid.get_col_row_by_num(6195600,6370200),(3,4))
        self.assertEqual(grid.get_col_row_by_num(6202680,4509018),(2,4))
        self.assertEqual(grid.get_col_row_by_num(6202980,1104480),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6203520,2787120),(1,4))
        self.assertEqual(grid.get_col_row_by_num(6210000,4571640),(2,4))
        self.assertEqual(grid.get_col_row_by_num(6212340,4584060),(2,4))
        self.assertEqual(grid.get_col_row_by_num(6216159,997560),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6218280,5028840),(2,4))
        self.assertEqual(grid.get_col_row_by_num(6218460,6370740),(3,4))
        self.assertEqual(grid.get_col_row_by_num(6220260,8147001),(4,4))
        self.assertEqual(grid.get_col_row_by_num(6224220,2741220),(1,4))
        self.assertEqual(grid.get_col_row_by_num(6226200,8067040),(4,4))
        self.assertEqual(grid.get_col_row_by_num(6234660,748260),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6235740,1358820),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6237720,4086720),(2,4))
        self.assertEqual(grid.get_col_row_by_num(6241500,615420),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6245820,4478220),(2,4))
        self.assertEqual(grid.get_col_row_by_num(6248160,1142640),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6255000,2773440),(1,4))
        self.assertEqual(grid.get_col_row_by_num(6267060,971460),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6273900,6578460),(3,4))
        self.assertEqual(grid.get_col_row_by_num(6277500,2700900),(1,4))
        self.assertEqual(grid.get_col_row_by_num(6279300,6368940),(3,4))
        self.assertEqual(grid.get_col_row_by_num(6279840,6349680),(3,4))
        self.assertEqual(grid.get_col_row_by_num(6285960,4609800),(2,4))
        self.assertEqual(grid.get_col_row_by_num(6287040,939600),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6295680,8134200),(4,4))
        self.assertEqual(grid.get_col_row_by_num(6302160,4173120),(2,4))
        self.assertEqual(grid.get_col_row_by_num(6302160,5968800),(3,4))
        self.assertEqual(grid.get_col_row_by_num(6303960,2341440),(1,4))
        self.assertEqual(grid.get_col_row_by_num(6305400,685440),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6311880,5016600),(2,4))
        self.assertEqual(grid.get_col_row_by_num(6313140,2830140),(1,4))
        self.assertEqual(grid.get_col_row_by_num(6317640,3130560),(1,4))
        self.assertEqual(grid.get_col_row_by_num(6319620,4584600),(2,4))
        self.assertEqual(grid.get_col_row_by_num(6390360,4533480),(2,4))
        self.assertEqual(grid.get_col_row_by_num(6417432,951480),(0,4))
        self.assertEqual(grid.get_col_row_by_num(6442619,2802960),(1,4))
        self.assertEqual(grid.get_col_row_by_num(733680,8139780),(4,0))
        self.assertEqual(grid.get_col_row_by_num(733680,952020),(0,0))
        self.assertEqual(grid.get_col_row_by_num(750600,3751620),(2,0))
        self.assertEqual(grid.get_col_row_by_num(820080,952200),(0,0))
        self.assertEqual(grid.get_col_row_by_num(844380,8159580),(4,0))
        self.assertEqual(grid.get_col_row_by_num(845820,3599460),(1,0))



    def test_read_CK20_and_check_titles(self):
        grid = self.get_singleton_grid()
        self.assertEqual(grid.tag,core.make_title("Top page"))


    def test_read_CK20_and_check_color(self):
        grid = self.get_singleton_grid()
        self.assertEqual(grid.colors[2][2],(255,125,236))

    def test_create_obf_object(self):
        grid = self.get_singleton_grid()
        obf=grid.create_obf_object()
        with tempfile.NamedTemporaryFile() as tmp:
            with open(tmp.name, 'w') as outfile:
                json.dump(obf, outfile, sort_keys=True, indent=2)
            self.maxDiff = None
            self.assertMultiLineEqual(open('tests/testtargets/singleobffile.obf').read().strip(),open(tmp.name).read().strip())


    def test_read_CK20_and_check_link(self):
        grid = self.get_singleton_grid()
        self.assertNotEqual(grid.links[4][1],"")

    def test_read_CK20_and_check_link_neg(self):
        grid = self.get_singleton_grid()
        self.assertEqual(grid.links[1][1],"")

    def test_create_icon_name(self):
            grid = self.get_singleton_grid()
            self.assertEqual(True,self.check_icon_name(grid,1,2,"S0X1Y2people.png"))
            self.assertEqual(True,self.check_icon_name(grid,1,3,"S0X1Y3go.png"))
            self.assertEqual(True,self.check_icon_name(grid,1,4,"S0X1Y4time.png"))
            with self.assertRaises(ValueError):
                grid.icon_name(1,-1)
            self.assertEqual(True,self.check_icon_name(grid,2,1,"S0X2Y1chatting.png"))
            self.assertEqual(True,self.check_icon_name(grid,2,2,"S0X2Y2personalcare.png"))
            self.assertEqual(True,self.check_icon_name(grid,2,3,"S0X2Y3want.png"))
            self.assertEqual(True,self.check_icon_name(grid,2,4,"S0X2Y4places.png"))
            with self.assertRaises(ValueError):
                grid.icon_name(2,9)
            self.assertEqual(True,self.check_icon_name(grid,3,1,"S0X3Y1questions.png"))
            self.assertEqual(True,self.check_icon_name(grid,3,2,"S0X3Y2littlewords.png"))
            self.assertEqual(True,self.check_icon_name(grid,3,3,"S0X3Y3describing.png"))
            self.assertEqual(True,self.check_icon_name(grid,3,4,"S0X3Y4leisure.png"))
            with self.assertRaises(ValueError):
                grid.icon_name(3,5)
            with self.assertRaises(ValueError):
                grid.icon_name(5,3)
            self.assertEqual(True,self.check_icon_name(grid,4,1,"S0X4Y1food.png"))
            self.assertEqual(True,self.check_icon_name(grid,4,2,"S0X4Y2myday.png"))
            self.assertEqual(True,self.check_icon_name(grid,4,3,"S0X4Y3things.png"))
            self.assertEqual(True,self.check_icon_name(grid,4,4,"S0X4Y4deleteword.png"))

    def check_icon_name(self,grid,x,y,result):
        if result ==grid.icon_name(x,y):
            return True
        else:
            print("There has been an error in check_icon_name")
            print(result)
            print(grid.icon_name(x,y))
            return False 


if __name__=="__main__":
    unittest.main()
